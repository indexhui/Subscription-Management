(this["webpackJsonpsbscription-management"]=this["webpackJsonpsbscription-management"]||[]).push([[0],{90:function(e,n,t){"use strict";t.r(n);var a=t(107),r=t(0),c=t(69),i=t.n(c),o=t(10),s=t(6),u=t(20),l=t(11),p=t.n(l),d=t(24),b=t(3),j=t(109),h=t(103),x=t(101),f=Object(x.a)({config:{initialColorMode:"light",useSystemColorMode:!1},initialColorMode:"light",useSystemColorMode:!1,styles:{global:{body:{bg:"gray.900",fontFamily:"'PingFang TC', \u5fae\u8edf\u6b63\u9ed1\u9ad4, sans-serif"},activeStyle:{color:"red"}}},components:{Button:{baseStyle:{fontWeight:"300",borderRadius:"full",letterSpacing:2},sizes:{lg:{h:12,minW:12,px:30}}}}}),m=t(102),O=t(2),g=function(e){var n=e.numOfRemaing,t=e.sum;return Object(O.jsxs)(m.a,{children:[Object(O.jsxs)(m.a,{children:["\u7e3d\u5171\u6709 ",n," \u7b46\u8a02\u95b1\u670d\u52d9"]}),Object(O.jsxs)(m.a,{children:["\u6bcf\u500b\u6708\u60a8\u9700\u82b1\u8cbb ",t]})]})},v=t(108),y=t(111),w=t(105),C=t(62),S=function(e){var n=e.sub,t=e.id,a=e.isEdit,c=e.handleDelete,i=e.updateIsEdit,o=e.handleSave,l=Object(r.useState)(n),p=Object(b.a)(l,2),d=p[0],j=p[1],x=function(e){var n=e.target.name,t=e.target.value;j(Object(u.a)(Object(u.a)({},d),{},Object(s.a)({},n,t)))},f=function(e){13===e.keyCode&&0!==d.length&&o({id:t,tempSub:d}),27===e.keyCode&&(i({id:n.id,isEdit:!1}),j(n))};return Object(O.jsxs)(h.a,{bg:"white",boxShadow:"0px 4px 25px rgba(201, 201, 201, 0.5)",padding:"12px 32px",borderRadius:"6px",color:"gray.800",justify:"space-between",alignItems:"center",m:"8px 0",role:"group",position:"relative",children:[Object(O.jsxs)(h.a,{align:"center",children:[Object(O.jsx)(v.a,{colorScheme:"cyan",children:Object(O.jsx)(m.a,{bg:"gray.900",color:"white",w:"40px",h:"40px",lineHeight:"40px",textAlign:"center",borderRadius:"2px",mr:"2",children:n.name&&n.name.slice(0,1).toUpperCase()})}),Object(O.jsxs)(m.a,{children:[Object(O.jsxs)(m.a,{onDoubleClick:function(){return i({id:t,isEdit:!0})},children:[!a&&n.name,a&&Object(O.jsx)(y.a,{name:"name",value:d.name,onChange:x,onKeyDown:f,placeholder:"edit",size:"s",border:"0px",bg:"gray.100",w:"80%"})]}),Object(O.jsxs)(m.a,{onDoubleClick:function(){return i({id:t,isEdit:!0})},children:[!a&&n.plan,a&&Object(O.jsx)(y.a,{value:d.plan,name:"plan",onChange:x,onKeyDown:f,placeholder:"edit",size:"s",border:"0px",bg:"gray.100",w:"80%"})]})]})]}),Object(O.jsxs)(m.a,{children:[Object(O.jsxs)(m.a,{children:[!a&&n.price,a&&Object(O.jsx)(y.a,{value:d.price,name:"price",onChange:x,onKeyDown:f,placeholder:"edit",size:"s",border:"0px",bg:"gray.100",w:"80%"})]}),Object(O.jsx)(m.a,{children:"/month"})]}),Object(O.jsxs)(h.a,{display:"none",position:"absolute",right:"0",top:"0",bg:"white",h:"100%",w:"28px",borderRadius:"6px",color:"gray.500",boxShadow:"0px 4px 25px rgba(201, 201, 201, 0.5)",_groupHover:{display:"flex"},align:"center",direction:"column",justify:"center",children:[Object(O.jsx)(m.a,{py:"2px",mt:"5px",children:Object(O.jsx)(w.a,{as:C.b,_hover:{color:"gray.800"},onClick:c(t)})}),Object(O.jsx)(m.a,{py:"2px",mb:"5px",onClick:function(){return i({id:t,isEdit:!0})},children:Object(O.jsx)(w.a,{as:C.a,_hover:{color:"gray.800"},py:"1px"})})]})]})},k=function(e){var n=e.subs,t=e.handleDelete,a=e.updateIsEdit,r=e.handleSave;return Object(O.jsx)(m.a,{children:n&&n.map((function(e){return Object(O.jsx)(S,{sub:e.fields,isEdit:e.isEdit,id:e.id,handleDelete:t,updateIsEdit:a,handleSave:r},e.id)}))})},E=t(42),D=t(106),R=t(110),N=function(e){var n=e.inputValue,t=e.handleSubmit,a=e.handleChange;return Object(O.jsxs)(h.a,{w:"45%",bg:"white",ml:"20px",borderRadius:"4px",color:"gray.700",padding:"32px",direction:"column",children:["\u65b0\u589e\u8a02\u95b1\u9805\u76ee",Object(O.jsxs)("form",{onSubmit:t,children:[Object(O.jsxs)(E.a,{isRequired:!0,children:[Object(O.jsx)(D.a,{children:"\u670d\u52d9\u540d\u7a31"}),Object(O.jsx)(y.a,{placeholder:"\u670d\u52d9\u540d\u7a31",onChange:a,value:n.name,name:"name"})]}),Object(O.jsxs)(E.a,{isRequired:!0,children:[Object(O.jsx)(D.a,{children:"\u65b9\u6848"}),Object(O.jsx)(y.a,{placeholder:"\u65b9\u6848",name:"plan",onChange:a,value:n.plan})]}),Object(O.jsxs)(E.a,{isRequired:!0,children:[Object(O.jsx)(D.a,{children:"\u91d1\u984d"}),Object(O.jsx)(y.a,{placeholder:"\u91d1\u984d",name:"price",onChange:a,value:n.price})]}),Object(O.jsx)(R.a,{mt:4,colorScheme:"teal",type:"submit",children:"Submit"})]})]})},G="https://api.airtable.com/v0/appAPGGGa6GPLdEdJ/subscription?api_key=keyNCBsmapwe9NAJ7",J=function(){var e=Object(d.a)(p.a.mark((function e(n){var t,a,r,c,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.name,a=n.plan,r=n.price,e.next=3,fetch("".concat(G),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({fields:{plan:a,price:r,name:t}})});case 3:return c=e.sent,e.next=6,c.json();case 6:return i=e.sent,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),P=function(){var e=Object(d.a)(p.a.mark((function e(n){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(G,"&records[]=").concat(n),{method:"DELETE",headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),T=function(){var e=Object(d.a)(p.a.mark((function e(n){var t,a,r,c,i,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.id,a=n.name,r=n.plan,c=n.price,e.next=3,fetch("".concat("https://api.airtable.com/v0/appAPGGGa6GPLdEdJ/subscription","/").concat(t,"?").concat("api_key=keyNCBsmapwe9NAJ7"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({fields:{plan:r,price:c,name:a}})});case 3:return i=e.sent,e.next=6,i.json();case 6:return o=e.sent,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();var I=function(){var e=Object(r.useState)(),n=Object(b.a)(e,2),t=n[0],a=n[1],c=Object(r.useState)({name:"",plan:"",price:""}),i=Object(b.a)(c,2),l=i[0],x=i[1];Object(r.useEffect)((function(){(function(){var e=Object(d.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(G)).then((function(e){return e.json()}));case 2:n=e.sent,a(n.records);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var m=function(){var e=Object(d.a)(p.a.mark((function e(n){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,J({name:l.name,plan:l.plan,price:l.price});case 3:t=e.sent,a((function(e){return[].concat(Object(o.a)(e),[t])})),x({name:"",plan:"",price:""});case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),v=function(){var e=Object(d.a)(p.a.mark((function e(n){var t,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.id,r=n.tempSub,e.next=3,T({id:t,name:r.name,plan:r.plan,price:r.price});case 3:a((function(e){return e.map((function(e){return e.id!==t?e:Object(u.a)(Object(u.a)({},e),{},{fields:r,isEdit:!1})}))}));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),y=null===t||void 0===t?void 0:t.length;return Object(O.jsx)(j.a,{theme:f,children:Object(O.jsx)(h.a,{justify:"center",mt:"20",children:Object(O.jsxs)(h.a,{w:"760px",children:[Object(O.jsxs)(h.a,{w:"55%",direction:"column",bg:"white",borderRadius:"4px",padding:"32px",pl:"24px",children:[Object(O.jsx)(g,{sum:t&&function(e){var n=0;return null===e||void 0===e||e.forEach((function(e){var t=e.fields.price;t&&!isNaN(t)&&(n+=Number(t))})),n}(t),numOfRemaing:y}),Object(O.jsx)(k,{subs:t,handleDelete:function(e){return Object(d.a)(p.a.mark((function n(){return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(e),n.prev=1,n.next=4,P(e);case 4:a((function(n){return n.filter((function(n){return n.id!==e}))})),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(1),console.log(n.t0);case 10:case"end":return n.stop()}}),n,null,[[1,7]])})))},updateIsEdit:function(e){var n=e.id,r=e.isEdit;a((function(e){return e.map((function(e){return e.id!==n?e:(console.log(n,e.id),Object(u.a)(Object(u.a)({},e),{},{isEdit:r}))}))})),console.log(t)},handleSave:v})]}),Object(O.jsx)(N,{inputValue:l,handleSubmit:m,handleChange:function(e){var n=e.target.name,t=e.target.value;x(Object(u.a)(Object(u.a)({},l),{},Object(s.a)({},n,t)))}})]})})})},A=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,112)).then((function(n){var t=n.getCLS,a=n.getFID,r=n.getFCP,c=n.getLCP,i=n.getTTFB;t(e),a(e),r(e),c(e),i(e)}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(O.jsx)(r.StrictMode,{children:Object(O.jsxs)("div",{children:[Object(O.jsx)(a.a,{}),Object(O.jsx)(I,{})]})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),A()}},[[90,1,2]]]);
//# sourceMappingURL=main.247d9e31.chunk.js.map